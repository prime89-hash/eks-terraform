# 🏗️ Architecture Documentation

## System Architecture Overview

### 3-Tier Architecture Pattern

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           PRESENTATION TIER                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  Internet → CloudFront → WAF → API Gateway → Rate Limiting → Authentication │
└─────────────────────────┬───────────────────────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────────────────────┐
│                          APPLICATION TIER                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│  VPC Link → NLB → ALB → EKS Fargate → Spring Boot → Business Logic         │
└─────────────────────────┬───────────────────────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────────────────────┐
│                            DATA TIER                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  RDS PostgreSQL → Secrets Manager → KMS → Backup → Multi-AZ                │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Detailed Network Architecture

### VPC Layout (10.0.0.0/16)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              AWS VPC (10.0.0.0/16)                         │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         PUBLIC SUBNETS                              │   │
│  │                                                                     │   │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐     │   │
│  │  │   us-west-2a    │  │   us-west-2b    │  │   us-west-2c    │     │   │
│  │  │  10.0.101.0/24  │  │  10.0.102.0/24  │  │  10.0.103.0/24  │     │   │
│  │  │                 │  │                 │  │                 │     │   │
│  │  │  ┌─────────────┐│  │  ┌─────────────┐│  │  ┌─────────────┐│     │   │
│  │  │  │     ALB     ││  │  │ NAT Gateway ││  │  │   Bastion   ││     │   │
│  │  │  │   (Public)  ││  │  │             ││  │  │   (Optional)││     │   │
│  │  │  └─────────────┘│  │  └─────────────┘│  │  └─────────────┘│     │   │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                       │
│                                    ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        PRIVATE SUBNETS                              │   │
│  │                                                                     │   │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐     │   │
│  │  │   us-west-2a    │  │   us-west-2b    │  │   us-west-2c    │     │   │
│  │  │   10.0.1.0/24   │  │   10.0.2.0/24   │  │   10.0.3.0/24   │     │   │
│  │  │                 │  │                 │  │                 │     │   │
│  │  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────┐ │     │   │
│  │  │ │ EKS Fargate │ │  │ │ EKS Fargate │ │  │ │     RDS     │ │     │   │
│  │  │ │    Pods     │ │  │ │    Pods     │ │  │ │ PostgreSQL  │ │     │   │
│  │  │ └─────────────┘ │  │ └─────────────┘ │  │ │  Multi-AZ   │ │     │   │
│  │  │                 │  │                 │  │ └─────────────┘ │     │   │
│  │  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │                 │     │   │
│  │  │ │     NLB     │ │  │ │ Monitoring  │ │  │                 │     │   │
│  │  │ │ (Internal)  │ │  │ │   Stack     │ │  │                 │     │   │
│  │  │ └─────────────┘ │  │ └─────────────┘ │  │                 │     │   │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Request Flow Architecture

### API Gateway to Application Flow

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │    │ API Gateway │    │  VPC Link   │    │     NLB     │
│             │───▶│             │───▶│             │───▶│ (Internal)  │
│ • Browser   │    │ • Auth      │    │ • Private   │    │ • TCP       │
│ • Mobile    │    │ • Rate Limit│    │ • Secure    │    │ • Health    │
│ • API       │    │ • Transform │    │ • Managed   │    │ • Route     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                                  │
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│     RDS     │    │ EKS Fargate │    │     ALB     │    │             │
│             │◀───│             │◀───│             │◀───┘             │
│ • PostgreSQL│    │ • Spring    │    │ • HTTPS     │                  │
│ • Encrypted │    │ • Boot      │    │ • SSL Term  │                  │
│ • Multi-AZ  │    │ • Auto Scale│    │ • Health    │                  │
│ • Backup    │    │ • Metrics   │    │ • Route     │                  │
└─────────────┘    └─────────────┘    └─────────────┘                  │
```

### Monitoring Data Flow

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Application │    │ Micrometer  │    │ Prometheus  │    │   Grafana   │
│             │───▶│             │───▶│             │───▶│             │
│ • Metrics   │    │ • Collect   │    │ • Store     │    │ • Visualize │
│ • Health    │    │ • Format    │    │ • Query     │    │ • Alert     │
│ • Custom    │    │ • Export    │    │ • Rules     │    │ • Dashboard │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                              │
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ CloudWatch  │    │AlertManager │    │     SNS     │
│             │    │             │◀───┘             │
│ • AWS Logs  │    │ • Rules     │                  │
│ • Metrics   │    │ • Route     │                  │
│ • Alarms    │    │ • Notify    │                  │
└─────────────┘    └─────────────┘                  │
```

## Security Architecture

### Defense in Depth

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              SECURITY LAYERS                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        PERIMETER SECURITY                           │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │     WAF     │  │ CloudFront  │  │    DDoS     │                 │   │
│  │  │ • Rules     │  │ • CDN       │  │ Protection  │                 │   │
│  │  │ • Bot Block │  │ • Cache     │  │ • Shield    │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                       │
│  ┌─────────────────────────────────▼───────────────────────────────────┐   │
│  │                        NETWORK SECURITY                             │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │     VPC     │  │   Subnets   │  │  Security   │                 │   │
│  │  │ • Isolation │  │ • Private   │  │   Groups    │                 │   │
│  │  │ • Flow Logs │  │ • Public    │  │ • Firewall  │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                       │
│  ┌─────────────────────────────────▼───────────────────────────────────┐   │
│  │                      APPLICATION SECURITY                           │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │     IAM     │  │   RBAC      │  │   Secrets   │                 │   │
│  │  │ • Roles     │  │ • K8s Auth  │  │  Manager    │                 │   │
│  │  │ • Policies  │  │ • Service   │  │ • Rotation  │                 │   │
│  │  │ • OIDC      │  │   Accounts  │  │ • Encrypt   │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                       │
│  ┌─────────────────────────────────▼───────────────────────────────────┐   │
│  │                         DATA SECURITY                               │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │     KMS     │  │ Encryption  │  │   Backup    │                 │   │
│  │  │ • Keys      │  │ • At Rest   │  │ • Point in  │                 │   │
│  │  │ • Rotation  │  │ • In Transit│  │   Time      │                 │   │
│  │  │ • Audit     │  │ • TLS 1.2+  │  │ • Encrypted │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## CI/CD Pipeline Architecture

### GitHub Actions Workflow

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   GitHub    │    │   GitHub    │    │     AWS     │    │     EKS     │
│ Repository  │───▶│   Actions   │───▶│   (OIDC)    │───▶│   Cluster   │
│             │    │             │    │             │    │             │
│ • Code      │    │ • Test      │    │ • Auth      │    │ • Deploy    │
│ • Config    │    │ • Build     │    │ • Terraform │    │ • Monitor   │
│ • Docs      │    │ • Deploy    │    │ • ECR Push  │    │ • Validate  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### Pipeline Stages Detail

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              CI/CD PIPELINE                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│  │    TEST     │───▶│  TERRAFORM  │───▶│ INFRA DEPLOY│───▶│ BUILD & PUSH│  │
│  │             │    │    PLAN     │    │             │    │             │  │
│  │ • Unit Test │    │ • Validate  │    │ • EKS       │    │ • Docker    │  │
│  │ • Gradle    │    │ • Plan      │    │ • RDS       │    │ • ECR Push  │  │
│  │ • Security  │    │ • Review    │    │ • API GW    │    │ • Tag       │  │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘  │
│                                                                  │          │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│  │   NOTIFY    │◀───│   MONITOR   │◀───│ APP DEPLOY  │◀───┘             │  │
│  │             │    │             │    │             │                     │
│  │ • Slack     │    │ • Health    │    │ • K8s       │                     │
│  │ • Email     │    │ • Metrics   │    │ • Rolling   │                     │
│  │ • Status    │    │ • Validate  │    │ • Verify    │                     │
│  └─────────────┘    └─────────────┘    └─────────────┘                     │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Scalability Architecture

### Horizontal Scaling

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            SCALING STRATEGY                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      APPLICATION SCALING                            │   │
│  │                                                                     │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │   │
│  │  │   Pod 1     │    │   Pod 2     │    │   Pod N     │             │   │
│  │  │             │    │             │    │             │             │   │
│  │  │ • CPU: 250m │    │ • CPU: 250m │    │ • CPU: 250m │             │   │
│  │  │ • Mem: 512M │    │ • Mem: 512M │    │ • Mem: 512M │             │   │
│  │  │ • Auto Scale│    │ • Auto Scale│    │ • Auto Scale│             │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘             │   │
│  │                                                                     │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │              HORIZONTAL POD AUTOSCALER                      │   │   │
│  │  │  • CPU Threshold: 70%                                       │   │   │
│  │  │  • Memory Threshold: 80%                                    │   │   │
│  │  │  • Min Replicas: 2                                          │   │   │
│  │  │  • Max Replicas: 10                                         │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      DATABASE SCALING                              │   │
│  │                                                                     │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │   │
│  │  │   Primary   │    │  Read Rep 1 │    │  Read Rep N │             │   │
│  │  │     RDS     │───▶│     RDS     │    │     RDS     │             │   │
│  │  │             │    │             │    │             │             │   │
│  │  │ • Writes    │    │ • Reads     │    │ • Reads     │             │   │
│  │  │ • Multi-AZ  │    │ • Scale Out │    │ • Scale Out │             │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘             │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Disaster Recovery Architecture

### Multi-Region Setup (Optional)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DISASTER RECOVERY                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      PRIMARY REGION (us-west-2)                    │   │
│  │                                                                     │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │   │
│  │  │     EKS     │  │     RDS     │  │     S3      │  │ CloudWatch  │ │   │
│  │  │   Active    │  │   Primary   │  │   Bucket    │  │    Logs     │ │   │
│  │  │             │  │             │  │             │  │             │ │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘ │   │
│  └─────────────────────────┬───────────────────────────────────────────┘   │
│                            │                                               │
│                            ▼ (Cross-Region Replication)                   │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    SECONDARY REGION (us-east-1)                    │   │
│  │                                                                     │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │   │
│  │  │     EKS     │  │     RDS     │  │     S3      │  │ CloudWatch  │ │   │
│  │  │  Standby    │  │ Read Replica│  │  Replicated │  │    Logs     │ │   │
│  │  │             │  │             │  │             │  │             │ │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

This architecture provides a comprehensive, scalable, and secure foundation for modern cloud-native applications with complete observability and automated operations.
